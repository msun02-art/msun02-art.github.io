<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>FUNRUN – Homepage</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Carlito:wght@400;700&display=swap"
    />
    <link rel="stylesheet" href="stylerun3.css" />
    <link rel="stylesheet" href="globals.css" />
  </head>

  <body>
    <div class="wrapper-main">
      <div class="iphone-pro">
        <!-- 顶部头像 + 名字 -->
        <header class="top-bar">
          <div class="user-info">
            <div class="avatar-circle"></div>
            <span class="username">Username</span>
          </div>
        </header>

        <div class="top-divider"></div>

        <!-- 中间大网格背景区域 -->
        <div class="yellow-grid">
          <!-- 一行星期 + 一行日期 -->
          <div class="calendar-week">
            <div class="calendar-weekdays">
              <span>Mon</span>
              <span>Tue</span>
              <span>Wed</span>
              <span>Thu</span>
              <span>Fri</span>
              <span>Sat</span>
              <span>Sun</span>
            </div>

            <div class="calendar-dates" id="calendar-dates"></div>
          </div>

          <!-- Progress block -->
          <div class="progress-red">
            <div class="progress-header">Progress</div>
            <div class="progress-grid" id="progress-grid"></div>
          </div>

          <!-- Plan block -->
          <div class="plan-shape"></div>
          <div class="plan-header">Plan</div>
        </div>

        <!-- 底部导航 -->
        <nav class="bottom-nav">
          <button class="nav-item nav-home active">Home</button>
          <button class="nav-item nav-run">Run Mode</button>
          <button class="nav-item nav-gallery">Gallery</button>
        </nav>
      </div>
    </div>

    <script>
      // ========= 生成本周 7 天，今天高亮橙色圆点 =========
      const datesRow = document.getElementById("calendar-dates");

      const today = new Date();
      const todayDay = today.getDate();
      const todayMonth = today.getMonth();
      const todayYear = today.getFullYear();

      // JS: 0=Sun,1=Mon,...  转成以 Mon 为 0
      const jsDay = today.getDay();
      const mondayIndex = (jsDay + 6) % 7; // 0=Mon, 6=Sun

      const startOfWeek = new Date(
        todayYear,
        todayMonth,
        todayDay - mondayIndex
      );

      datesRow.innerHTML = "";
      for (let i = 0; i < 7; i++) {
        const d = new Date(
          startOfWeek.getFullYear(),
          startOfWeek.getMonth(),
          startOfWeek.getDate() + i
        );

        const span = document.createElement("span");
        span.className = "calendar-date";
        span.textContent = d.getDate();

        if (
          d.getDate() === todayDay &&
          d.getMonth() === todayMonth &&
          d.getFullYear() === todayYear
        ) {
          span.classList.add("is-today");
        }

        datesRow.appendChild(span);
      }

      // ========= 点击跳转逻辑 =========

      // 整个 calendar 区域点一下跳到 calendar 页面（如果你需要）
      const calendarWeek = document.querySelector(".calendar-week");
      if (calendarWeek) {
        calendarWeek.addEventListener("click", () => {
          window.location.href = "calendar.html";
        });
      }

      // Progress 方块
      const progressCard = document.querySelector(".progress-red");
      if (progressCard) {
        progressCard.addEventListener("click", () => {
          window.location.href = "progress.html";
        });
      }

      // Plan：形状和文字都可以点
      function goPlan() {
        window.location.href = "plan.html";
      }
      const planShape = document.querySelector(".plan-shape");
      const planHeader = document.querySelector(".plan-header");
      if (planShape) planShape.addEventListener("click", goPlan);
      if (planHeader) planHeader.addEventListener("click", goPlan);

      // ========= 底部导航 =========
      const homeBtn = document.querySelector(".nav-home");
      if (homeBtn) {
        homeBtn.addEventListener("click", () => {
          window.location.href = "homepage.html";
        });
      }

      const runBtn = document.querySelector(".nav-run");
      if (runBtn) {
        runBtn.addEventListener("click", () => {
          window.location.href = "runmode.html";
        });
      }

      const galleryBtn = document.querySelector(".nav-gallery");
      if (galleryBtn) {
        galleryBtn.addEventListener("click", () => {
          window.location.href = "gallery.html";
        });
      }
    </script>
  </body>
</html>